# Простой программируемый вычислитель на SystemC

## Описание
Этот проект представляет собой реализацию простого программируемого вычислителя с использованием библиотеки SystemC. Вычислитель реализует конвейерную архитектуру с четырьмя стадиями и поддерживает базовые операции загрузки, сложения и сохранения данных.

## Архитектура

### Конвейер
Вычислитель реализует 4-стадийный конвейер:
1. **Декодирование (Decode)** - чтение и декодирование инструкции из памяти
2. **Чтение (Read)** - чтение операндов из регистров
3. **Исполнение (Execute)** - выполнение арифметической операции
4. **Запись (Writeback)** - сохранение результата в регистр

### Регистры
- 4 регистра общего назначения (R0-R3)
- Программный счетчик (PC)

### Память
- Размер памяти: 4KB (0x1000 байт)
- Адресация: байтовая
- Начальный адрес программы: 0x200

### Поддерживаемые инструкции
1. **LOAD** - загрузка данных из памяти в регистр
   - Формат: `LOAD Rd, addr`
   - Пример: `LOAD R0, 0x100` - загрузить значение из памяти по адресу 0x100 в регистр R0

2. **ADD** - сложение значений регистров
   - Формат: `ADD Rd, Rs1, Rs2`
   - Пример: `ADD R2, R0, R1` - сложить значения регистров R0 и R1, результат сохранить в R2

3. **STORE** - сохранение значения регистра в память
   - Формат: `STORE Rs, addr`
   - Пример: `STORE R2, 0x108` - сохранить значение регистра R2 в память по адресу 0x108

4. **HALT** - остановка выполнения программы

### Формат инструкции
```cpp
struct Instruction {
    uint8_t type;     // Тип инструкции (LOAD, ADD, STORE, HALT)
    uint8_t reg1;     // Первый регистр (назначение для LOAD/ADD, источник для STORE)
    uint8_t reg2;     // Второй регистр (первый операнд для ADD)
    uint8_t reg3;     // Третий регистр (второй операнд для ADD)
    uint32_t address; // Адрес памяти для LOAD/STORE
};
```

## Компоненты системы

### Calculator
Основной модуль вычислителя, реализующий конвейерную архитектуру:
- Поддерживает неблокирующий доступ к памяти (nb_transport)
- Реализует проверки границ памяти и регистров
- Выводит отладочную информацию о выполнении инструкций

### Memory
Модуль памяти с поддержкой TLM интерфейса:
- Инициализирует память тестовой программой
- Управляет сигналом начала работы вычислителя
- Устанавливает начальный адрес программы

## Тестовая программа
```cpp
// Загрузка первого числа
LOAD R0, 0x100  // R0 = mem[0x100] = 10

// Загрузка второго числа
LOAD R1, 0x104  // R1 = mem[0x104] = 20

// Сложение чисел
ADD R2, R0, R1  // R2 = R0 + R1 = 30

// Сохранение результата
STORE R2, 0x108 // mem[0x108] = R2 = 30

// Остановка
HALT
```

## Сборка и запуск
```bash
# Сборка
make

# Запуск
./bin/simple_calculator_pipeline
```

## Требования
- SystemC 3.0.1 или выше
- C++ компилятор с поддержкой C++11
- Make

## Обработка ошибок
Вычислитель реализует следующие проверки:
- Выход за границы памяти при чтении/записи
- Недопустимые значения регистров
- Ошибки при работе с памятью
- Неизвестные инструкции

При обнаружении ошибки выводится соответствующее сообщение и выполнение программы прерывается.